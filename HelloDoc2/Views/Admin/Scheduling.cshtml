@model DAL.ViewModel.SchedulingVm;@using System.Globalization;@{
    Layout = "~/Views/Shared/_LayoutMainAdminDashboard.cshtml";
    var shiftViewMessage = TempData["ViewShiftMessage"] as string;

    var newShift = TempData["NewShift"] as string;}<head>    <style>        .fc th {            color: white;            background-color: dimgray;        }        #calendar .fc-timeline-slot-cushion, .fc-col-header-cell-cushion {            text-decoration: none;            color: white;        }        .fc .fc-timeline-slot-cushion {            color: white;        }        .fc-daygrid-day-top {            background-color: #ffacf5;            justify-content: center;        }        .fc-daygrid-day-number {            text-decoration: none;            color: ActiveCaption;        }        /*.fc-daygrid-event-harness {            border-bottom: 1px solid        }*/        .fc-event-time, .fc-event-title {            color: black;            font-size: 10px;        }        .fc-event {            margin-top: 1px !important;        }        .fc .fc-daygrid-day-number {            color: black;        }        .fc-timeline-event .fc-event-title {            white-space: normal !important;        }    </style>
</head><div class="container-fluid bg-body-tertiary vh-100">        <div class="container d-flex flex-column mt-3 gap-2 p-3 ">            <div class="container d-flex justify-content-between p-0 my-2">                <p class="h4">Scheduling </p>                <button type="button" class="btn btn-info rounded-1 border-info">                <span class="text-white">&lt; Back </span>                                    </button>            </div>            <div class="d-flex justify-content-between ">                <select class="form-select mb-2 w-25" id="Region">                    <option value="0" selected>All Region</option>                    @foreach (var item in Model.region)
                    {                        <option value="@item.RegionId">@item.Name</option>                    }                </select>                <div class="d-flex justify-content-end ">@*                     <button class="btn btn-info rounded-2 ms-2 text-white text-center" onclick="window.location.href='@Url.Action("ProviderOnCall","Admin")'">Provider On Call</button>                    <button class="btn btn-info rounded-2 ms-2 text-white text-center" onclick="window.location.href='@Url.Action("RequestedShift","Admin")'">Shift For Review</button>                    <button class="btn btn-info rounded-2 ms-2 text-white text-center createShift">Add New Shift</button> *@                </div>                <div>                    <button class="btn btn-info text-white" onclick="window.location.href='@Url.Action("ProviderOnCall","Admin")'">Provider On Call</button>                    <button class="btn btn-info text-white" onclick="window.location.href='@Url.Action("RequestedShift","Admin")'">Shift For Review</button>                    <button class="btn btn-info createShift text-white">Add New Shift</button>                </div>            </div>            <p class="fw-bolder h5" id="calendarTitle"></p>            <div class="d-flex justify-content-between flex-column flex-md-row mb-3">                <div class="d-flex justify-content-center align-items-center mb-3">                    <button class="btn bg-info text-white rounded-pill me-2" onclick="calendarPrev()"><i class="bi bi-chevron-left"></i></button>                    <i class="bi bi-calendar3" onclick="calendarToday()"></i>                    <button class="btn bg-info text-white rounded-pill ms-2"><i class="bi bi-chevron-right" onclick="calendarNext()"></i></button>                </div>                <div>                    <div class="mb-3 d-flex justify-content-center align-items-center">                    <span class="rounded-2" style="background:#edacd2; width:2rem; height:1.5rem"></span>                        <span class="d-flex justify-content-center align-items-center me-3">                            <span class="customPinkPill me-2"></span>Pending Shifts                        </span>                    <span class="rounded-2" style="background:#a5cfa6; width:2rem; height:1.5rem"></span>                        <span class="d-flex justify-content-center align-items-center">                            <span class="customGreenPill me-2"></span>Approved Shifts                        </span>                     </div>                    <div class="flex-grow-1 text-end">                        <div class="d-flex justify-content-end">                            <input type="radio" class="btn-check" name="options-base" id="Day" autocomplete="off" onclick="changeView('resourceTimeline')" checked>                            <label class="btn btn-outline-info" for="Day">Day</label>                            <input type="radio" class="btn-check" name="options-base" id="Week" autocomplete="off" onclick="changeView('resourceTimelineWeek')" >                            <label class="btn btn-outline-info mx-2" for="Week">Week</label>                            <input type="radio" class="btn-check" name="options-base" id="Month" autocomplete="off" onclick="changeView('dayGridMonth')">                            <label class="btn btn-outline-info" for="Month">Month</label>                        </div>                    </div>                </div>            </div>            <div id="scheduleContent">            </div>                <div id="ViewShift"></div>        </div></div><div id="createshift"></div><script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fullcalendar-scheduler@6.1.11/index.global.min.js"></script><script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script><script>    window.addEventListener('beforeunload', function () {        // Delete the specific local storage item        localStorage.removeItem('type');    });    var calendar;    document.addEventListener('DOMContentLoaded', function () {        GetCalendar(0);        function GetCalendar(RegionId) {            var calendarEl = document.getElementById('scheduleContent');            calendar = new FullCalendar.Calendar(calendarEl, {                height: 'auto',                schedulerLicenseKey: 'GPL-My-Project-Is-Open-Source',                themeSystem: 'bootstrap5',                headerToolbar: false,                initialView: 'resourceTimeline',                eventDisplay: 'block',                datesSet: function (info) {                    var title = info.view.title;                    $("#calendarTitle").html(title);                    loadResources();                    loadShifts();                },                eventClick: function (info, jsEvent, view) {                    ViewShift(info.event.id);                },                views: {                    resourceTimelineWeek: {                        slotDuration: { days: 1 },                        slotLabelFormat: { weekday: 'short', day: 'numeric', week: 'long' }                    }                },                resourceLabelDidMount: function (resourceObj) {                    const img = document.createElement('img');                    img.src = resourceObj.resource.extendedProps.imageUrl || "/images/logo.png";                    img.style.maxHeight = '40px';                    resourceObj.el.querySelector('.fc-datagrid-cell-main').appendChild(img);                },                 //resources: "/Admin/GetProviderDetailsForSchedule?regionId=" + RegionId,                 //events: "/Admin/GetScheduleData",            });            calendar.render();        };        var type1 = localStorage.getItem('type') || 'Day';        $('#' + type1).click();    });    let calendarNext = () => calendar.next();    let calendarPrev = () => calendar.prev();    let calendarToday = () => calendar.today();    let changeView = (type) => calendar.changeView(type);</script><script>    $('.createShift').click(function () {        $.ajax({            url: "/Admin/CreateShift",            type: "GET",            dataType: "html",            success: function (data) {                $("#createshift").html(data);                $("#CreateShiftContent").modal("show");            },            error: function () {                $("#createshift").html('An error has occurred');            }        });    });    $("#Region").on("change", function () {        loadShifts();        loadResources();    });    function ViewShift(ShiftDetailId) {        $.ajax({            type: "GET",            url: "/Admin/ViewShift",            data: { ShiftDetailId },            success: function (data) {                $("#ViewShift").html(data);                $("#ViewShiftContent").modal("show");            },            error: function (data) {                toastr.error("Cannot Fetch Shift Details");            }        })    };    function loadResources() {        $.ajax({            url: '/Admin/GetProviderDetailsForSchedule',            data: { RegionId: $("#Region").val() },            type: 'GET',            success: function (data) {                var resources = calendar.getResources();                resources.forEach(function (resource) {                    resource.remove();                });                data.forEach(function (event) {                    calendar.addResource(event);                });            },            error: function (xhr, status, error) {                toastr.error('Error fetching schedule data:', error);            }        });    }    function loadShifts() {        $.ajax({            url: '/Admin/GetScheduleData',            data: { RegionId: $("#Region").val() },            type: 'GET',            success: function (data) {                calendar.removeAllEvents();                data.forEach(function (event) {                    calendar.addEvent(event);                });            },            error: function (xhr, status, error) {                toastr.error('Error fetching schedule data:', error);            }        });    };    //this is for display success sweet msg : shift deleted successfully    if ('@shiftViewMessage') {        Swal.fire({            icon: 'success',            title: 'Shift Deleted Successfully!',            timer: 2000, // Auto close the alert after 3 seconds            timerProgressBar: true,            showConfirmButton: false        });    };        //this is for display success sweet msg that : create shift successfully    if ('@newShift') {        Swal.fire({            icon: 'success',            title: 'New Shift Created!',            timer: 2000, // Auto close the alert after 3 seconds            timerProgressBar: true,            showConfirmButton: false        });    };</script>